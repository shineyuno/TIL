# 2.3 개발자를 위한 테스팅 프레임워크  JUnit

### 포괄적인 테스트
스프링의 창시자 로드 존슨은 "항상 네거티브 테스트를 먼저 만들라"는 조언을 했다.
개발자는 빨리 테스트를 만들어 성공하는 것을 보고 다음 기능으로 나아가고 싶어하기 때문에, 긍정적인 경우를 골라서
성공할 만한 테스트를 먼저 작성하게 되기가 쉽다.

## 2.3.4
### 기능설계를 위한 테스트

```java
@Test(expected=EmptyResultDataAccessException.class) // 테스트중에 발생할 것으로 기대하는 예외 클래스를 지정해준다.
public void getUserFailure() throws SQLException {
  ApplicationContext context = new GenericXmlApplicationContext("applicationContext.xml");
  
  UserDao dao = context.getBean("userDao", UserDao.class);
  dao.deleteAll();
  assertThat(dao.getCount(), is(0));
  
  dao.get("unknown_id"); // 이 메소드 실행 중에 예외가 발생해야 한다. 예외가 발생하지 않으면 테스트가 실패한다.
}
```


getUserFailure() 테스트 코드에 나타난 기능

|     | 단계  | 내용   | 코드 |
| :---- | :----------- | :-- | :-- |
| 조건   | 어떤 조건을 가지고  | 가져올 사용자 정보가 존재하지 않는 경우에   | dao.deleteAll();  <br /> assertThat(dao.getCount(), is(0)); |
| 행위   | 무엇을 할 때      | 존재하지 않는 id로 get()을 실행하면 |  get("unknown_id"); |
| 결과   | 어떤 결과가 나온다  | 특별한 예외가 던져진다  | @Test(expected=EmptyResultDataAccessException.class)  |

이 테스트 코드는 마치 잘 작성된 하나의 기능정의서처럼 보인다. 그래서 보통 기능설계, 구현, 테스트라는 일반적인 개발 흐름의 
기능설계에 해당하는 부분을 이 테스트 코드가 일부분 담당하고 있다고 볼 수도 있다.

### 테스트 주도 개발
만들고자 하는 기능의 내용을 담고 있으면서 만들어진 코드를 검증도 해줄 수 있도록 테스트 코드를 먼저 만들고, 테스트를 성공하게 해주는 코드를
작성하는 방식의 개발방법이 있다. 이를 **테스트 주도 개발** TDD(test Driven Development)이라고 한다.
"실패한 테스트를 성공시키키 위한 목적이 아닌 코드는 만들지 않는다"는 것이  TDD의 기본원칙이다.
이원칙을 따랐다면 만들어진 모든 코드는 빠짐없이 테스트로 검증된 것이라고 볼 수 있다.

TDD를 하면 자연스럽게 단위 테스트를 만들 수 있다.

TDD의 장점 중 하나는 코드를 만들어 테스트를 실행하는 그 사이의 간격이 매우 짧다는 점이다. 개발한 코드의 오류는 빨리 발견할수록 좋다.
빨리 발견된 오류는 쉽게 대응이 가능하기 때문이다.

### @Before
JUnit이 하나의 테스트 클래스를 가져와 테스트를 수행하는 방식은 다음과 같다.
1. 테스트 클래스에 @Test가 붙은 public이고 void형이며 파라미터가 없는 테스트 메소드를 모두 찾는다.
2. 테스트 클래스의 오브젝트를 하나 만든다.
3. @Before가 붙은 메소드가 있으면 실행한다.
4. @Test가 붙은 메소드를 하나 호출하고 테스트 결과를 저장해둔다.
5. @After가 붙은 메소드가 있으면 실행한다.
6. 나머지 테스트 메소드에 대해 2~5번을 반복한다.
7. 모든 테스트의 결과를 종합해서 돌려준다.

@Before나 @After 메소드를 테스트 메소드에서 직접 호출하지 않기 때문에 서로 주고받을 정보나 오브젝트가 있다면 인스턴스 변수를 이용해야 한다.

### 픽스처
테스트를 수행하는 데 필요한 정보나 오브젝트를 픽스처(fixture)라고 한다. 
일반적으로 픽스처는 여러테스트에서 반복적으로 사용되기 때문에 @Before 메소드를 이용해 생성해두면 편리하다.
