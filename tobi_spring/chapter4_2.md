# 4.2 예외 전환
 예외 전환의 목적은 두 가지
런타임 예외로 포장해서 굳이 필요하지 않은 catch/thorws를 줄여주는 것
로우레벨의 예외를 좀 더 의미 있고 추상화된 예외로 바꿔서 던져주는 것

## 4.2.2 DB 에러 코드 매핑을 통한 전환
스프링은 DB별 에러코드를 분류해서 스프링이 정의한 예외 클래스와 매핑해 놓은 에러 코드 매핑정보 테이블을 
만들어두고 이를 이용한다.
JdbcTemplate은 SQLException을 단지 런타임 예외인 DataAccessException으로 포장하는 것이 아니라
DB의 에러 코드를 DataAccessException 계층구조의 클래스 중 하나로 매핑해준다.
전환되는 JdbcTemplate에서 던지는 예외는 모두 DataAccessException의 서브클래스 타입이다. 
드라이버나 DB메타정보를 참고해서 DB 종류를 확인하고 DB별로 미리 준비된 리스트  매핑 정보를 참고해서 
적절한 예외클래스를 선택하기 때문에 DB가 달라져도 같은 종류의 에러라면 동일한 예외를 받을수 있는 것이다.

## 4.2.3 DAO 인터페이스와 DataAccessException 계층 구조
자바에는 JDBC외에도 데이터 액세스를 위한 표준 기술이 존재한다. JDO와 JPA는 JDBC와 마찬가지로 자바의 표준 퍼시스턴스 기술이지만
JDBC와는 성격과 사용 방법이 크게 다르다. 오라클의 TopLink 같은 사용제품이나 오픈소스인 하이버네이트 같은 표준을 따르긴
하지만 독자적인 프로그래밍 모델을 지원하는 ORM 기술도 있다.
JDBC를 기반으로 하고, 성격도 비슷하지만 사용 방법과 API, 발생하는 예외가 다른 iBatis도 있다.
DataAccessException은 의미가 같은 예외라면 데이터 액세스 기술의 종류와 상관없이 일관된 예외가 발생하도록 만들어준다.

JDBC보다는 늦게 등장한 JDO, Hibernate, JPA 등의 기술은 SQLException 같은 체크 예외 대신 런타인 예외를 사용한다. 따라서
throws에 선언을 해주지 않아도 된다.

### 데이테 액세스 예외 추상화와 DataAccessException 계층구조
JDO, JPA, 하이버네이트처럼 오브젝트/엔티티 단위로 업데이트하는 경우에는 낙관적인 락킹(optimistic locking)이 발생할 수 있다.
이 낙관적인 락킹은 같은 정보를 두 명 이상의 사용자가 동시에 조회하고 순차적으로 업데이트를 할 때, 뒤늦게 업데이트한 것이 
먼저 업데이트한 것을 덮어쓰지 않도록 막아주는 데 쓸 수 이스는 편리한 기능이다. 이런 예외들은 사용자에게 적절한 안내 메시지를 
보여주고, 다시 시도할 수 있도록 해줘야 한다.

DAO를 데이터 액세스 기술에서 독립시키려면 인터페이스 도입과 런타임 예외 전환, 기술에 독립적인 추상화된 예외로 전환이 필요하다.
